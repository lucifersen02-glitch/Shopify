{% schema %}
{
  "name": "Product Main",
  "settings": [
    {
      "type": "checkbox",
      "id": "enable_zoom",
      "label": "Enable image zoom",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_vendor",
      "label": "Show vendor",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_sku",
      "label": "Show SKU",
      "default": false
    }
  ]
}
{% endschema %}

<section class="product-main">
  <div class="container">
    <div class="product-main__wrapper">
      <!-- Product Images -->
      <div class="product-main__images">
        <div class="product-images">
          {% if product.featured_image %}
            <div class="product-images__main">
              <img 
                src="{{ product.featured_image | image_url: width: 800 }}" 
                alt="{{ product.featured_image.alt | escape }}"
                class="product-images__featured"
                id="ProductImage"
                loading="eager"
              >
              {% if section.settings.enable_zoom %}
                <div class="product-images__zoom"></div>
              {% endif %}
            </div>
          {% endif %}

          {% if product.images.size > 1 %}
            <div class="product-images__thumbnails">
              {% for image in product.images %}
                <button 
                  class="product-images__thumbnail {% if forloop.first %}active{% endif %}"
                  data-image-index="{{ forloop.index0 }}"
                  aria-label="View product image {{ forloop.index }}"
                >
                  <img 
                    src="{{ image | image_url: width: 150 }}" 
                    alt="{{ image.alt | escape }}"
                    loading="lazy"
                  >
                </button>
              {% endfor %}
            </div>
          {% endif %}
        </div>
      </div>

      <!-- Product Information -->
      <div class="product-main__info">
        <div class="product-info">
          {% if section.settings.show_vendor and product.vendor != blank %}
            <div class="product-info__vendor">
              <span>{{ product.vendor }}</span>
            </div>
          {% endif %}

          <h1 class="product-info__title">{{ product.title }}</h1>

          {% if section.settings.show_sku and product.selected_or_first_available_variant.sku != blank %}
            <div class="product-info__sku">
              <span class="product-info__sku-label">SKU:</span>
              <span class="product-info__sku-value">{{ product.selected_or_first_available_variant.sku }}</span>
            </div>
          {% endif %}

          <div class="product-info__rating">
            <div class="product-rating">
              {% for i in (1..5) %}
                <svg width="20" height="20" viewBox="0 0 24 24" fill="{% if i <= 4 %}currentColor{% else %}none{% endif %}" stroke="currentColor" stroke-width="2" xmlns="http://www.w3.org/2000/svg">
                  <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
                </svg>
              {% endfor %}
              <span class="product-rating__text">(4.5) â€¢ 120 Reviews</span>
            </div>
          </div>

          <div class="product-info__price">
            <span class="product-price">
              <span class="product-price__current">{{ product.selected_or_first_available_variant.price | money }}</span>
              {% if product.selected_or_first_available_variant.compare_at_price > product.selected_or_first_available_variant.price %}
                <span class="product-price__compare">{{ product.selected_or_first_available_variant.compare_at_price | money }}</span>
                <span class="product-price__discount">
                  {{ product.selected_or_first_available_variant.compare_at_price | minus: product.selected_or_first_available_variant.price | times: 100.0 | divided_by: product.selected_or_first_available_variant.compare_at_price | round }}% OFF
                </span>
              {% endif %}
            </span>
          </div>

          <div class="product-info__description">
            <p>{{ product.description | strip_html | truncatewords: 50 }}</p>
          </div>

          <form action="{{ routes.cart_add_url }}" method="post" enctype="multipart/form-data" class="product-form" id="product-form">
            <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}" id="product-variant-id">

            {% unless product.has_only_default_variant %}
              <div class="product-form__variants">
                {% for option in product.options_with_values %}
                  <div class="product-form__option">
                    <label class="product-form__option-label">{{ option.name }}</label>
                    <div class="product-form__option-values">
                      {% for value in option.values %}
                        <button
                          type="button"
                          class="product-form__option-value {% if option.selected_value == value %}active{% endif %}"
                          data-option="{{ option.name }}"
                          data-value="{{ value }}"
                        >
                          {{ value }}
                        </button>
                      {% endfor %}
                    </div>
                  </div>
                {% endfor %}
              </div>
            {% endunless %}

            <div class="product-form__quantity">
              <label for="Quantity" class="product-form__quantity-label">Quantity</label>
              <div class="product-form__quantity-controls">
                <button type="button" class="product-form__quantity-btn" data-action="decrease" aria-label="Decrease quantity">-</button>
                <input 
                  type="number" 
                  id="Quantity" 
                  name="quantity" 
                  value="1" 
                  min="1" 
                  class="product-form__quantity-input"
                >
                <button type="button" class="product-form__quantity-btn" data-action="increase" aria-label="Increase quantity">+</button>
              </div>
            </div>

            <div class="product-form__actions">
              <button 
                type="submit" 
                name="add" 
                class="button button--primary product-form__submit"
                id="AddToCart"
                {% unless product.selected_or_first_available_variant.available %}disabled{% endunless %}
              >
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M9 22C9.55228 22 10 21.5523 10 21C10 20.4477 9.55228 20 9 20C8.44772 20 8 20.4477 8 21C8 21.5523 8.44772 22 9 22Z" stroke="currentColor" stroke-width="2"/>
                  <path d="M20 22C20.5523 22 21 21.5523 21 21C21 20.4477 20.5523 20 20 20C19.4477 20 19 20.4477 19 21C19 21.5523 19.4477 22 20 22Z" stroke="currentColor" stroke-width="2"/>
                  <path d="M1 1H5L7.68 14.39C7.77144 14.8504 8.02191 15.264 8.38755 15.5583C8.75318 15.8526 9.2107 16.009 9.68 16H19.4C19.8693 16.009 20.3268 15.8526 20.6925 15.5583C21.0581 15.264 21.3086 14.8504 21.4 14.39L23 6H6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>
                  {% if product.selected_or_first_available_variant.available %}
                    Add to Cart
                  {% else %}
                    Sold Out
                  {% endif %}
                </span>
              </button>
              <button type="button" class="button button--secondary product-form__wishlist" aria-label="Add to wishlist">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" xmlns="http://www.w3.org/2000/svg">
                  <path d="M20.84 4.61C20.3292 4.099 19.7228 3.69364 19.0554 3.41708C18.3879 3.14052 17.6725 2.99817 16.95 2.99817C16.2275 2.99817 15.5121 3.14052 14.8446 3.41708C14.1772 3.69364 13.5708 4.099 13.06 4.61L12 5.67L10.94 4.61C9.9083 3.57831 8.50903 2.99871 7.05 2.99871C5.59096 2.99871 4.19169 3.57831 3.16 4.61C2.1283 5.64169 1.54871 7.04097 1.54871 8.5C1.54871 9.95903 2.1283 11.3583 3.16 12.39L4.22 13.45L12 21.23L19.78 13.45L20.84 12.39C21.351 11.8792 21.7564 11.2728 22.0329 10.6054C22.3095 9.93789 22.4518 9.22248 22.4518 8.5C22.4518 7.77752 22.3095 7.0621 22.0329 6.39464C21.7564 5.72718 21.351 5.12075 20.84 4.61Z"/>
                </svg>
              </button>
            </div>

            {% unless product.selected_or_first_available_variant.available %}
              <p class="product-form__sold-out">This product is currently sold out.</p>
            {% endunless %}
          </form>

          <div class="product-info__features">
            <div class="product-features-list">
              <div class="product-features-list__item">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" xmlns="http://www.w3.org/2000/svg">
                  <path d="M9 11L12 14L22 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M21 12V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>Free Shipping on orders over $50</span>
              </div>
              <div class="product-features-list__item">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" xmlns="http://www.w3.org/2000/svg">
                  <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M12 6V12L16 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>30-Day Return Policy</span>
              </div>
              <div class="product-features-list__item">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" xmlns="http://www.w3.org/2000/svg">
                  <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>Premium Quality Guaranteed</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
